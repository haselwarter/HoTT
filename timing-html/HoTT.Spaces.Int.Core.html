<html>
<head>
<title>Core.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Core.v</h1>

<div class="code" title="File: Core.v
Line: 1
Time: 0.027s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Basics.</pre>
</div>
<div class="code" title="File: Core.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Spaces.Pos.</pre>
</div>
<div class="code" title="File: Core.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * The Integers. *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Close Scope trunc_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Close Scope nat_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope positive_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Definition of the Integers *)

(** We define an integer as being a positive number labelled negative, zero or a positive number labelled positive. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Inductive Int : Type0 :=
  | neg : Pos -&gt; Int
  | zero : Int
  | pos : Pos -&gt; Int.</pre>
</div>
<div class="code" title="File: Core.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Declare Scope int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Delimit Scope int_scope with int.</pre>
</div>
<div class="code" title="File: Core.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The integers are a pointed type *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ispointed_Int : IsPointed Int := zero.</pre>
</div>
<div class="code" title="File: Core.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Properties of constructors *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition neg_inj {z w : Pos} (p : neg z = neg w) : z = w
  := transport (fun s =&gt; z =
    (match s with neg a =&gt; a | zero =&gt; w | pos a =&gt; w end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pos_inj {z w : Pos} (p : pos z = pos w) : z = w
  := transport (fun s =&gt; z =
    (match s with neg a =&gt; w | zero =&gt; w | pos a =&gt; a end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition neg_neq_zero {z : Pos} : ~ (neg z = zero)
  := fun p =&gt; transport (fun s =&gt;
    match s with neg a =&gt; z = a| zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 34
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>

Definition pos_neq_zero {z : Pos} : ~ (pos z = zero)
  := fun p =&gt; transport (fun s =&gt;
    match s with pos a =&gt; z = a | zero =&gt; Empty | neg _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition neg_neq_pos {z w : Pos} : ~ (neg z = pos w)
  := fun p =&gt; transport (fun s =&gt;
    match s with neg a =&gt; z = a | zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 42
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>

Definition zero_neq_neg {z : Pos} := @neg_neq_zero z o symmetry _ _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 44
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>

Definition zero_neq_pos {z : Pos} := @pos_neq_zero z o symmetry _ _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pos_neq_neg {z w : Pos} := @neg_neq_pos z w o symmetry _ _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Conversion with a decimal representation for printing/parsing *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_to_decimal_int (n : Int) : Decimal.int :=
  match n with
    | neg m =&gt; Decimal.Neg (pos_to_uint m)
    | zero  =&gt; Decimal.Pos Decimal.Nil
    | pos m =&gt; Decimal.Pos (pos_to_uint m)
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition int_to_number_int (n : Int) : Numeral.int :=
  Numeral.IntDec (int_to_decimal_int n).</pre>
</div>
<div class="code" title="File: Core.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint int_of_decimal_uint (d : Decimal.uint) : Int :=
  match d with
    | Decimal.Nil =&gt; zero
    | Decimal.D0 l =&gt; int_of_decimal_uint l
    | Decimal.D1 l =&gt; pos (pos_of_uint_acc l 1)
    | Decimal.D2 l =&gt; pos (pos_of_uint_acc l 1~0)
    | Decimal.D3 l =&gt; pos (pos_of_uint_acc l 1~1)
    | Decimal.D4 l =&gt; pos (pos_of_uint_acc l 1~0~0)
    | Decimal.D5 l =&gt; pos (pos_of_uint_acc l 1~0~1)
    | Decimal.D6 l =&gt; pos (pos_of_uint_acc l 1~1~0)
    | Decimal.D7 l =&gt; pos (pos_of_uint_acc l 1~1~1)
    | Decimal.D8 l =&gt; pos (pos_of_uint_acc l 1~0~0~0)
    | Decimal.D9 l =&gt; pos (pos_of_uint_acc l 1~0~0~1)
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition int_of_decimal_int (d : Decimal.int) : Int :=
  match d with
    | Decimal.Pos u =&gt; int_of_decimal_uint u
    | Decimal.Neg u =&gt; let t := int_of_decimal_uint u in
        match t with
          | pos v =&gt; neg v
          | _ =&gt; zero
        end
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition int_of_number_int (d:Numeral.int) :=
  match d with
  | Numeral.IntDec d =&gt; Some (int_of_decimal_int d)
  | Numeral.IntHex _ =&gt; None
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Number Notation Int int_of_number_int int_to_number_int : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* For some reason 0 can be parsed as an integer, but is printed as [zero]. This notation fixes that. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation "0" := zero : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Doubling and variants *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_double x :=
  match x with
    | 0 =&gt; 0
    | pos p =&gt; pos p~0
    | neg p =&gt; neg p~0
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition int_succ_double x :=
  match x with
    | 0 =&gt; 1
    | pos p =&gt; pos p~1
    | neg p =&gt; neg (pos_pred_double p)
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition int_pred_double x :=
  match x with
    | 0 =&gt; neg 1%pos
    | neg p =&gt; neg p~1
    | pos p =&gt; pos (pos_pred_double p)
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Subtraction of positive into Int *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint int_pos_sub (x y : Pos) {struct y} : Int :=
  match x, y with
    | p~1, q~1 =&gt; int_double (int_pos_sub p q)
    | p~1, q~0 =&gt; int_succ_double (int_pos_sub p q)
    | p~1, 1 =&gt; pos p~0
    | p~0, q~1 =&gt; int_pred_double (int_pos_sub p q)
    | p~0, q~0 =&gt; int_double (int_pos_sub p q)
    | p~0, 1 =&gt; pos (pos_pred_double p)
    | 1, q~1 =&gt; neg q~0
    | 1, q~0 =&gt; neg (pos_pred_double q)
    | 1, 1 =&gt; zero
  end%pos.</pre>
</div>
<div class="code" title="File: Core.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Negation *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_negation x :=
  match x with
    | zero =&gt; zero
    | pos x =&gt; neg x
    | neg x =&gt; pos x
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "- x" := (int_negation x) : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma int_negation_negation n : --n = n.</pre>
</div>
<div class="code" title="File: Core.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by destruct n.</pre>
</div>
<div class="code" title="File: Core.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Addition *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 148
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>Definition int_add x y :=
  match x, y with
    | 0, y =&gt; y
    | x, 0 =&gt; x
    | pos x', pos y' =&gt; pos (x' + y')
    | pos x', neg y' =&gt; int_pos_sub x' y'
    | neg x', pos y' =&gt; int_pos_sub y' x'
    | neg x', neg y' =&gt; neg (x' + y')
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "+" := int_add : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Successor *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_succ x := x + 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Predecessor *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_pred x := x + neg 1%pos.</pre>
</div>
<div class="code" title="File: Core.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Subtraction *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_sub m n := m + -n.</pre>
</div>
<div class="code" title="File: Core.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "-" := int_sub : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Multiplication *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_mul x y :=
  match x, y with
    | 0, _ =&gt; 0
    | _, 0 =&gt; 0
    | pos x', pos y' =&gt; pos (x' * y')
    | pos x', neg y' =&gt; neg (x' * y')
    | neg x', pos y' =&gt; neg (x' * y')
    | neg x', neg y' =&gt; pos (x' * y')
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "*" := int_mul : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Power function *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_pow x y :=
  match y with
    | pos p =&gt; pos_iter (int_mul x) p 1
    | 0 =&gt; 1
    | neg _ =&gt; 0
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "^" := int_pow : int_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Square *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition int_square x :=
  match x with
    | 0 =&gt; 0
    | pos p =&gt; pos (pos_square p)
    | neg p =&gt; pos (pos_square p)
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Sign function *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition sgn z :=
  match z with
    | 0 =&gt; 0
    | pos p =&gt; 1
    | neg p =&gt; neg 1%pos
  end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Decidable paths and truncation. *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance decpaths_int : DecidablePaths Int.</pre>
</div>
<div class="code" title="File: Core.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 212
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>
  intros [n | | n] [m | | m].</pre>
</div>
<div class="code" title="File: Core.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 214
Time: 0.003s">
<div class="time" style="width: 11.111111111111%"></div>
<pre> destruct (dec (n = m)) as [p | q].</pre>
</div>
<div class="code" title="File: Core.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inl, ap, p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 216
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre> by apply inr; intro; apply q, neg_inj.</pre>
</div>
<div class="code" title="File: Core.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr neg_neq_zero).</pre>
</div>
<div class="code" title="File: Core.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr neg_neq_pos).</pre>
</div>
<div class="code" title="File: Core.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr zero_neq_neg).</pre>
</div>
<div class="code" title="File: Core.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl idpath).</pre>
</div>
<div class="code" title="File: Core.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr zero_neq_pos).</pre>
</div>
<div class="code" title="File: Core.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr pos_neq_neg).</pre>
</div>
<div class="code" title="File: Core.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr pos_neq_zero).</pre>
</div>
<div class="code" title="File: Core.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  +</pre>
</div>
<div class="code" title="File: Core.v
Line: 224
Time: 0.003s">
<div class="time" style="width: 11.111111111111%"></div>
<pre> destruct (dec (n = m)) as [p | q].</pre>
</div>
<div class="code" title="File: Core.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inl, ap, p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> by apply inr; intro; apply q, pos_inj.</pre>
</div>
<div class="code" title="File: Core.v
Line: 226
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Since integers have decidable paths they are a hset *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 229
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>Global Instance hset_int : IsHSet Int | 0 := _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

