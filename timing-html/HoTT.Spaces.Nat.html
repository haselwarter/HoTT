<html>
<head>
<title>Nat.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Nat.v</h1>

<div class="code" title="File: Nat.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)
(** * Theorems about the natural numbers *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 3
Time: 0.03s">
<div class="time" style="width: 50.847457627119%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 3
Time: 0.01s">
<div class="time" style="width: 16.949152542373%"></div>
<pre>
Require Import HoTT.Types.Bool.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 4
Time: 0.006s">
<div class="time" style="width: 10.169491525424%"></div>
<pre>
Require Import HoTT.TruncType.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 5
Time: 0.059s">
<div class="time" style="width: 100%"></div>
<pre>
Require Export HoTT.DProp.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Export HoTT.Basics.Nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Close Scope trunc_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "0" := O.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Constants *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation "0" := O.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "1" := (S O).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "2" := (S (S O)).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition zero := 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition one := 1.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition two := 2.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Basic operations *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition succ := S.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition pred n :=
  match n with
    | 0 =&gt; n
    | S u =&gt; u
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint add n m :=
  match n with
  | 0 =&gt; m
  | S p =&gt; S (p + m)
  end

where "n + m" := (add n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition double n := n + n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint mul n m :=
  match n with
  | 0 =&gt; 0
  | S p =&gt; m + p * m
  end

where "n * m" := (mul n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Truncated subtraction: [n-m] is [0] if [n&lt;=m] *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 51
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>Fixpoint sub n m :=
  match n, m with
  | S k, S l =&gt; k - l
  | _, _ =&gt; n
  end

where "n - m" := (sub n m) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Minimum, maximum *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint max n m :=
  match n, m with
    | 0, _ =&gt; m
    | S n', 0 =&gt; n
    | S n', S m' =&gt; S (max n' m')
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint min n m :=
  match n, m with
    | 0, _ =&gt; 0
    | S n', 0 =&gt; 0
    | S n', S m' =&gt; S (min n' m')
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Power *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint pow n m :=
  match m with
  | 0 =&gt; 1
  | S m =&gt; n * (pow n m)
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Euclidean division *)

(** This division is linear and tail-recursive.
    In [divmod], [y] is the predecessor of the actual divisor,
    and [u] is [y] minus the real remainder
*)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint divmod x y q u :=
  match x with
    | 0 =&gt; (q,u)
    | S x' =&gt; match u with
                | 0 =&gt; divmod x' y (S q) y
                | S u' =&gt; divmod x' y q u'
              end
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 95
Time: 0.002s">
<div class="time" style="width: 3.3898305084746%"></div>
<pre>

Definition div x y :=
  match y with
    | 0 =&gt; y
    | S y' =&gt; fst (divmod x y' 0 y')
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>

Definition modulo x y :=
  match y with
    | 0 =&gt; y
    | S y' =&gt; y' - snd (divmod x y' 0 y')
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "/" := div : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Infix "mod" := modulo : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Greatest common divisor *)

(** We use Euclid algorithm, which is normally not structural,
    but Coq is now clever enough to accept this (behind modulo
    there is a subtraction, which now preserves being a subterm)
*)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint gcd a b :=
  match a with
   | O =&gt; b
   | S a' =&gt; gcd (b mod (S a')) (S a')
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Square *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition square n := n * n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Square root *)

(** The following square root function is linear (and tail-recursive).
  With Peano representation, we can't do better. For faster algorithm,
  see Psqrt/Zsqrt/Nsqrt...

  We search the square root of n = k + p^2 + (q - r)
  with q = 2p and 0&lt;=r&lt;=q. We start with p=q=r=0, hence
  looking for the square root of n = k. Then we progressively
  decrease k and r. When k = S k' and r=0, it means we can use (S p)
  as new sqrt candidate, since (S k')+p^2+2p = k'+(S p)^2.
  When k reaches 0, we have found the biggest p^2 square contained
  in n, hence the square root of n is p.
*)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint sqrt_iter k p q r :=
  match k with
    | O =&gt; p
    | S k' =&gt; match r with
                | O =&gt; sqrt_iter k' (S p) (S (S q)) (S (S q))
                | S r' =&gt; sqrt_iter k' p q r'
              end
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition sqrt n := sqrt_iter n 0 0 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Log2 *)

(** This base-2 logarithm is linear and tail-recursive.

  In [log2_iter], we maintain the logarithm [p] of the counter [q],
  while [r] is the distance between [q] and the next power of 2,
  more precisely [q + S r = 2^(S p)] and [r&lt;2^p]. At each
  recursive call, [q] goes up while [r] goes down. When [r]
  is 0, we know that [q] has almost reached a power of 2,
  and we increase [p] at the next call, while resetting [r]
  to [q].

  Graphically (numbers are [q], stars are [r]) :

&lt;&lt;
                    10
                  9
                8
              7   *
            6       *
          5           ...
        4
      3   *
    2       *
  1   *       *
0   *   *       *
&gt;&gt;

  We stop when [k], the global downward counter reaches 0.
  At that moment, [q] is the number we're considering (since
  [k+q] is invariant), and [p] its logarithm.
*)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 185
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>Fixpoint log2_iter k p q r :=
  match k with
    | O =&gt; p
    | S k' =&gt; match r with
                | O =&gt; log2_iter k' (S p) (S q) q
                | S r' =&gt; log2_iter k' p (S q) r'
              end
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition log2 n := log2_iter (pred n) 0 1 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Iterator on natural numbers *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition iter (n:nat) {A} (f:A-&gt;A) (x:A) : A :=
 nat_rect (fun _ =&gt; A) x (fun _ =&gt; f) n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


Definition eq_S := @ap _ _ S.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Definition ap_S := @ap _ _ S.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Definition ap_nat := @ap nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve ap_S : v62.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve ap_nat : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem pred_Sn : forall n:nat, n = pred (S n).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simpl; reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Injectivity of successor *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition eq_add_S n m (H: S n = S m): n = m := ap pred H.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Immediate eq_add_S: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem not_eq_S : forall n m:nat, n &lt;&gt; m -&gt; S n &lt;&gt; S m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  red; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve not_eq_S: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition IsSucc (n:nat) : Type :=
  match n with
  | O =&gt; False
  | S p =&gt; True
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Zero is not the successor of a number *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem O_S : forall n:nat, 0 &lt;&gt; S n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 231
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  discriminate.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve O_S : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem n_Sn : forall n:nat, n &lt;&gt; S n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve n_Sn : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** addition *)
(* TODO: remove and use one def *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition plus (n m:nat) : nat := add n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Definition ap011_plus := @ap011 _ _ _ plus.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Definition ap011_nat := @ap011 nat nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve ap011_plus : v62.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve ap011_nat : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_n_O : forall n:nat, n = n + 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve plus_n_O: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_O_n : forall n:nat, 0 + n = n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_n_Sm : forall n m:nat, S (n + m) = n + S m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 262
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  intros n m; induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve plus_n_Sm: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma plus_Sn_m : forall n m:nat, S n + m = S (n + m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Standard associated names *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation plus_0_r_reverse := plus_n_O (only parsing).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation plus_succ_r_reverse := plus_n_Sm (only parsing).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Multiplication *)

(** TODO: remove and use one def *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition mult (n m:nat) : nat := mul n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Definition ap011_mult := @ap011 _ _ _  mult.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve ap011_mult : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma mult_n_O : forall n:nat, 0 = n * 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve mult_n_O : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma mult_n_Sm : forall n m:nat, n * m + n = n * S m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros; induction n as [| p H]; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct H; rewrite &lt;- plus_n_Sm; apply eq_S.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 292
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  pattern m at 1 3; elim m; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 293
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Resolve mult_n_Sm: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Standard associated names *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation mult_0_r_reverse := mult_n_O (only parsing).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation mult_succ_r_reverse := mult_n_Sm (only parsing).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Truncated subtraction: [m-n] is [0] if [n&gt;=m] *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition minus (n m:nat) : nat := sub n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Definition of the usual orders, the basic properties of [le] and [lt]
    can be found in files Le and Lt *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Inductive le' (n:nat) : nat -&gt; Type :=
  | le_n : le' n n
  | le_S : forall m:nat, le' n m -&gt; le' n (S m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(* Local Notation "n &lt;= m" := (le' n m) : nat_scope. *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>#[export] Hint Constructors le' : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(*i equivalent to : "Hints Resolve le_n le_S : core." i*)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition lt' (n m:nat) := le' (S n) m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Unfold lt' : core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Local Infix "&lt;" := lt' : nat_scope. *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ge (n m:nat) := le' m n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Unfold ge: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 317
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Local Infix "&gt;=" := ge : nat_scope. *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition gt (n m:nat) := lt' m n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
#[export] Hint Unfold gt: core.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Local Infix "&gt;" := gt : nat_scope. *)

(* Local Notation "x &lt;= y &lt;= z" := (x &lt;= y /\ y &lt;= z) : nat_scope. *)
(* (* Local Notation "x &lt;= y &lt; z" := (x &lt;= y /\ y &lt; z) : nat_scope. *) *)
(* Local Notation "x &lt; y &lt; z" := (x &lt; y /\ y &lt; z) : nat_scope. *)
(* Local Notation "x &lt; y &lt;= z" := (x &lt; y /\ y &lt;= z) : nat_scope. *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem le_pred : forall n m, le' n m -&gt; le' (pred n) (pred m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
induction 1; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct m; simpl; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem le_S_n : forall n m, le' (S n) (S m) -&gt; le' n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (le_pred (S n) (S m)).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Case analysis *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_case :
 forall (n:nat) (P:nat -&gt; Type), P 0 -&gt; (forall m:nat, P (S m)) -&gt; P n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Principle of double induction *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_double_ind :
 forall R:nat -&gt; nat -&gt; Type,
   (forall n:nat, R 0 n) -&gt;
   (forall n:nat, R (S n) 0) -&gt;
   (forall n m:nat, R n m -&gt; R (S n) (S m)) -&gt; forall n m:nat, R n m.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct m; auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Maximum and minimum : definitions and specifications *)

(* Theorem max_l : forall n m : nat, m &lt;= n -&gt; max n m = n. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem max_r : forall n m : nat, n &lt;= m -&gt; max n m = m. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem min_l : forall n m : nat, n &lt;= m -&gt; min n m = n. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(* Theorem min_r : forall n m : nat, m &lt;= n -&gt; min n m = m. *)
(* Proof. *)
(* induction n; destruct m; simpl; auto. inversion 1. *)
(* intros. apply f_equal. apply IHn. apply le_S_n. trivial. *)
(* Qed. *)

(** [n]th iteration of the function [f] *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint nat_iter (n:nat) {A} (f:A-&gt;A) (x:A) : A :=
  match n with
    | O =&gt; x
    | S n' =&gt; f (nat_iter n' f x)
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma nat_iter_succ_r n {A} (f:A-&gt;A) (x:A) :
  nat_iter (S n) f x = nat_iter n f (f x).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 392
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  induction n; intros; simpl; rewrite &lt;- ?IHn; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem nat_iter_plus :
  forall (n m:nat) {A} (f:A -&gt; A) (x:A),
    nat_iter (n + m) f x = nat_iter n f (nat_iter m f x).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 399
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  induction n; intros; simpl; rewrite ?IHn; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 400
Time: 0.002s">
<div class="time" style="width: 3.3898305084746%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Preservation of invariants : if [f : A-&gt;A] preserves the invariant [Inv],
    then the iterates of [f] also preserve it. *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem nat_iter_invariant :
  forall (n:nat) {A} (f:A -&gt; A) (P : A -&gt; Type),
    (forall x, P x -&gt; P (f x)) -&gt;
    forall x, P x -&gt; P (nat_iter n f x).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 409
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A f P Hf x Hx.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Hf, IHn; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We reopen these scopes so they take precedence over nat_scope; otherwise, now that we have [Coq.Init.Peano], we'd get [* : nat -&gt; nat -&gt; nat] rather than [* : Type -&gt; Type -&gt; Type]. *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Open Scope type_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Open Scope core_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** But in this file, we want to be able to use the usual symbols for natural number arithmetic. *)</pre>
</div>
<div class="code" title="File: Nat.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Scheme nat_ind := Induction for nat Sort Type.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Scheme nat_rec := Minimality for nat Sort Type.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Arithmetic *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma nat_plus_n_O : forall n:nat, n = n + 0.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl; apply ap; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma nat_plus_n_Sm : forall n m:nat, (n + m).+1 = n + m.+1.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 431
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros n m; induction n; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition nat_plus_comm (n m : nat) : n + m = m + n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 437
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert m; induction n as [|n IH]; intros m; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (nat_plus_n_O m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> transitivity (m + n).+1.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, IH.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply nat_plus_n_Sm.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Exponentiation *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint nat_exp (n m : nat) : nat
  := match m with
       | 0 =&gt; 1
       | S m =&gt; nat_exp n m * n
     end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Factorials *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint factorial (n : nat) : nat
  := match n with
       | 0 =&gt; 1
       | S n =&gt; S n * factorial n
     end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* here ends the old Types/Nat.v and starts Spaces.v *)

(** Much of the layout of this file is adapted from ssreflect *)

(** ** Equality *)
(** *** Boolean equality and its properties *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint code_nat (m n : nat) {struct m} : DHProp :=
  match m, n with
    | 0, 0 =&gt; True
    | m'.+1, n'.+1 =&gt; code_nat m' n'
    | _, _ =&gt; False
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "=n" := code_nat : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 473
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint idcode_nat {n} : (n =n n) :=
  match n as n return (n =n n) with
    | 0 =&gt; tt
    | S n' =&gt; @idcode_nat n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 479
Time: 0.004s">
<div class="time" style="width: 6.7796610169492%"></div>
<pre>

Fixpoint path_nat {n m} : (n =n m) -&gt; (n = m) :=
  match m as m, n as n return (n =n m) -&gt; (n = m) with
    | 0, 0 =&gt; fun _ =&gt; idpath
    | m'.+1, n'.+1 =&gt; fun H : (n' =n m') =&gt; ap S (path_nat H)
    | _, _ =&gt; fun H =&gt; match H with end
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_path_nat {n m} : IsEquiv (@path_nat n m).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (isequiv_adjointify
            (@path_nat n m)
            (fun H =&gt; transport (fun m' =&gt; (n =n m')) H idcode_nat)
            _ _).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Nat.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros []; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 495
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
    by destruct (IHn^)%path.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Nat.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Nat.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 497
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre> apply path_ishprop.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Nat.v
Line: 497
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 498
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>

Definition equiv_path_nat {n m} : (n =n m) &lt;~&gt; (n = m)
  := Build_Equiv _ _ (@path_nat n m) _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance decidable_paths_nat : DecidablePaths nat
  := fun n m =&gt; decidable_equiv _ (@path_nat n m) _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 504
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>

Global Instance hset_nat : IsHSet nat := _.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Natural number ordering *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition leq m n := ((m - n) =n 0).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition lt m n := leq (m.+1) n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "m &lt;= n" := (leq m n) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &lt; n" := (lt m n) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 513
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &gt;= n" := (n &lt;= m) (only parsing) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 514
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation "m &gt; n" := (n &lt; m) (only parsing) : nat_scope.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Theorems about natural number ordering *)

</pre>
</div>
<div class="code" title="File: Nat.v
Line: 518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint leq0n {n} : 0 &lt;= n :=
  match n as n return 0 &lt;= n with
    | 0 =&gt; tt
    | n'.+1 =&gt; @leq0n n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 522
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>

Fixpoint subnn {n} : n - n =n 0 :=
  match n as n return n - n =n 0 with
    | 0 =&gt; tt
    | n'.+1 =&gt; @subnn n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance leq_refl : Reflexive leq
  := @subnn.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint leqnSn {n} : n &lt;= S n :=
  match n as n return n &lt;= S n with
  | 0 =&gt; tt
  | n'.+1 =&gt; @leqnSn n'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 537
Time: 0.027s">
<div class="time" style="width: 45.762711864407%"></div>
<pre>

Fixpoint leq_transd {x y z} : (x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z)%dprop :=
  match x as x, y as y, z as z return (x &lt;= y -&gt; y &lt;= z -&gt; x &lt;= z)%dprop with
    | 0, 0, 0 =&gt; dprop_istrue
    | x'.+1, 0, 0 =&gt; dprop_istrue
    | 0, y'.+1, 0 =&gt; dprop_istrue
    | 0, 0, z'.+1 =&gt; dprop_istrue
    | x'.+1, y'.+1, 0 =&gt; dprop_istrue
    | x'.+1, 0, z'.+1 =&gt; dprop_istrue
    | 0, y'.+1, z'.+1 =&gt; @leq_transd 0 y' z'
    | x'.+1, y'.+1, z'.+1 =&gt; @leq_transd x' y' z'
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 549
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>

Global Instance leq_trans : Transitive (fun n m =&gt; leq n m)
  := @leq_transd.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 552
Time: 0.013s">
<div class="time" style="width: 22.033898305085%"></div>
<pre>

Fixpoint leq_antisymd {x y} : (x &lt;= y -&gt; y &lt;= x -&gt; x =n y)%dprop :=
  match x as x, y as y return (x &lt;= y -&gt; y &lt;= x -&gt; x =n y)%dprop with
    | 0, 0 =&gt; dprop_istrue
    | x'.+1, y'.+1 =&gt; @leq_antisymd x' y'
    | _, _ =&gt; dprop_istrue
  end.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 559
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma leq_antisym : forall {x y}, x &lt;= y -&gt; y &lt;= x -&gt; x = y.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y p q.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_nat.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 564
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply leq_antisymd; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 565
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition not_nltn n : ~ (n &lt; n).</pre>
</div>
<div class="code" title="File: Nat.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 569
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n as [|n IH]; simpl.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> auto.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply IH.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition leq1Sn {n} : 1 &lt;= n.+1 := tt.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Fixpoint leqdichot {m} {n} : ((m &lt;= n) + (m &gt; n))%type.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 578
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
  induction m, n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> left; reflexivity.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> left; apply leq0n.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> right; unfold lt; apply leq1Sn.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Nat.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert ((m &lt;= n) + (n &lt; m)) as X by apply leqdichot.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction X as [leqmn|ltnm].</pre>
</div>
<div class="code" title="File: Nat.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> left; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Nat.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> right; assumption.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 586
Time: 0.001s">
<div class="time" style="width: 1.6949152542373%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Nat.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

